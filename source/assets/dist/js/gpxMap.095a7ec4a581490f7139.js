!function(){"use strict";var t=document.getElementById("gpx-map");if(t){var a=t.dataset.track;if(a){var n=L.map("gpx-map",{scrollWheelZoom:!1});L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png").addTo(n);var r=[],e=[],o=0,l=null,i=null,d=null,s=document.getElementById("gpx-distance-slider"),c=L.divIcon({className:"gpx-marker-start",html:'<div style="background:#19a974;width:14px;height:14px;border-radius:50%;border:2px solid white;box-shadow:0 2px 4px rgba(0,0,0,0.3);"></div>',iconSize:[14,14],iconAnchor:[7,7]}),g=L.divIcon({className:"gpx-marker-end",html:'<div style="background:#FF725C;width:14px;height:14px;border-radius:50%;border:2px solid white;box-shadow:0 2px 4px rgba(0,0,0,0.3);"></div>',iconSize:[14,14],iconAnchor:[7,7]});new L.GPX(a,{async:!0,marker_options:{startIconUrl:"",endIconUrl:"",shadowUrl:""}}).on("loaded",(function(t){if(t.target.getLayers().forEach((function(t){t.getLatLngs&&u(t.getLatLngs(),r)})),0!==r.length){var a=function(t){for(var a,n,r,e,o,l,i,d,s,c=[0],g=0,h=1;h<t.length;h++)g+=(a=t[h-1].lat,n=t[h-1].lng,r=t[h].lat,e=t[h].lng,o=void 0,l=void 0,i=void 0,d=void 0,s=void 0,o=a*Math.PI/180,l=r*Math.PI/180,i=(r-a)*Math.PI/180,d=(e-n)*Math.PI/180,s=Math.sin(i/2)*Math.sin(i/2)+Math.cos(o)*Math.cos(l)*Math.sin(d/2)*Math.sin(d/2),2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371e3),c.push(g);return{distances:c,total:g}}(r);e=a.distances,o=a.total,l=L.polyline(r,{color:"#666666",weight:4,opacity:.3}).addTo(n),i=L.polyline(r,{color:"#FF725C",weight:4,opacity:.9}).addTo(n),L.marker([r[0].lat,r[0].lng],{icon:c}).addTo(n);var h=r[r.length-1];d=L.marker([h.lat,h.lng],{icon:g}).addTo(n),n.fitBounds(l.getBounds(),{padding:[30,30]}),s.value=100,s.disabled=!1,s.addEventListener("input",p)}else console.error("GPX map: No track coordinates found")})).on("error",(function(t){console.error("GPX map: Failed to load GPX file",t)}))}else console.error("GPX map: No track URL specified in data-track attribute")}function h(t){var a=function(t){if(r.length<2)return r;if(t<=0)return[r[0],r[0]];if(t>=o)return r;for(var a=[],n=0;n<e.length;n++){if(!(e[n]<=t)){var l=e[n-1],i=(t-l)/(e[n]-l),d=r[n-1],s=r[n];a.push({lat:d.lat+(s.lat-d.lat)*i,lng:d.lng+(s.lng-d.lng)*i});break}a.push(r[n])}return a}(t);if(i&&i.setLatLngs(a),d&&a.length>0){var n=a[a.length-1];d.setLatLng([n.lat,n.lng])}}function p(){h(parseFloat(s.value)/100*o)}function u(t,a){if(Array.isArray(t))for(var n=0;n<t.length;n++){var r=t[n];r&&"number"==typeof r.lat&&"number"==typeof r.lng?a.push({lat:r.lat,lng:r.lng}):Array.isArray(r)&&u(r,a)}}}();